<!DOCTYPE html>
<html>
<head>
    <title>Firebase Connection Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .log { background: #f5f5f5; padding: 15px; margin: 10px 0; border-radius: 5px; white-space: pre-wrap; }
        button { padding: 10px 20px; margin: 10px; background: #2196F3; color: white; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Firebase Dictionary Test</h1>
    <button onclick="testConnection()">Test Firebase Connection</button>
    <button onclick="listDictionary()">List Dictionary Words</button>
    
    <div id="log" class="log"></div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js';
        import { getFirestore, collection, getDocs, query, orderBy } from 'https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js';

        // Your Firebase config
        const firebaseConfig = {
            apiKey: "AIzaSyDOT1jC27f26f3BIW-yFcgHTLGdEWeiopQ",
            authDomain: "mm-kr-expo.firebaseapp.com",
            projectId: "mm-kr-expo",
            storageBucket: "mm-kr-expo.firebasestorage.app",
            messagingSenderId: "974504645463",
            appId: "1:974504645463:web:0cd68a7b52ea2bcddb6412"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        function log(message) {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.textContent += `[${timestamp}] ${message}\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        window.testConnection = function() {
            log('Testing Firebase connection...');
            try {
                log(`✅ Firebase app initialized: ${app.name}`);
                log(`✅ Firestore instance created`);
                log(`✅ Project ID: ${firebaseConfig.projectId}`);
            } catch (error) {
                log(`❌ Error: ${error.message}`);
            }
        };

        window.listDictionary = async function() {
            log('Loading dictionary from Firebase...');
            
            try {
                const q = query(collection(db, 'dictionary'), orderBy('korean'));
                const snapshot = await getDocs(q);
                
                if (snapshot.empty) {
                    log('❌ No dictionary words found in Firebase');
                    log('Try running the migration tool first!');
                } else {
                    log(`✅ Found ${snapshot.size} words in Firebase dictionary:`);
                    
                    snapshot.forEach(doc => {
                        const data = doc.data();
                        log(`- ${data.korean} → ${data.myanmar} (${data.english || 'no english'}) [${data.pos || 'no pos'}]`);
                    });
                }
                
            } catch (error) {
                log(`❌ Error loading dictionary: ${error.message}`);
            }
        };
    </script>
</body>
</html>